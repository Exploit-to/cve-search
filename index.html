<!DOCTYPE html>
<html>

<head>
    <meta content="initial-scale=1, maximum-scale=1, 
                user-scalable=0" name="viewport" />
    <meta name="viewport" content="width=device-width" />

    <!-- Stylesheets for bootstrap + datatables 5 -->
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.1/css/bootstrap.min.css'>
    <link rel='stylesheet' href='https://cdn.datatables.net/1.11.4/css/dataTables.bootstrap5.min.css'>
    <script type="text/javascript" href="https://cdn.datatables.net/1.11.4/js/dataTables.bootstrap5.min.js"></script> 

    <!-- JS for jquery + datatables + datatables>bootstrap-->
    <link rel='stylesheet' href='https://cdn.datatables.net/1.12.1/css/jquery.dataTables.min.css'>
    <link rel='stylesheet' href='https://cdn.datatables.net/rowreorder/1.2.8/css/rowReorder.dataTables.min.css'>
    <link rel='stylesheet' href='https://cdn.datatables.net/responsive/2.3.0/css/responsive.dataTables.min.css'>
    
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.js">
    </script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.11.4/js/jquery.dataTables.min.js">
    </script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.11.4/js/dataTables.bootstrap5.min.js">
    </script>
    <script type="text/javascript" src="https://cdn.datatables.net/responsive/2.3.0/js/dataTables.responsive.min.js">
    </script>
    <script type="text/javascript" src="https://cdn.datatables.net/rowreorder/1.2.8/js/dataTables.rowReorder.min.js">
    </script>

    
    </script>

    <style>
        body {
            margin-top: 5%;
            font-size:12px;
            margin-left:5%;
            margin-right:5%;
        }


    </style>
</head>

<body>

    <!-- Bootstrap overlay div with growing spinner -->
    <div id="overlay">
        <div class="spinner"></div>
        <br />
        Loading... (usually 5-10s)
    </div>


    <div class="row justify-content-center">
        <div class="">
            <h2>CVE Search</h2>
            <!--HTML table with student data-->
            <!-- <table id="datatable" class="table table-striped table-bordered" style="display:none" cellspacing="0"> -->
            <table id="datatable" class="table table-bordered table-striped display compact"  cellspacing="0">
                <thead>
                    <tr>
                        <th>CVE_Year</th>
                        <th>CVE_Name</th>
                        <th >CVE_description</th>
                        <th>CVE_github</th>
                        <th>CVE_references</th>
                    </tr>
                </thead>
                <tfoot>
                    <tr>
                        <th>CVE_Year</th>
                        <th>CVE_Name</th>
                        <th>CVE_description</th>
                        <th>CVE_github</th>
                        <th>CVE_references</th>
                    </tr>
                </tfoot>

            </table>
        </div>
    </div>

    <footer class="mt-auto text-black-50">
        <p>Searchable CVEs from <a href="https://github.com/trickest/cve" class="text">https://github.com/trickest/cve</a></p>
    </footer>

    <script type="application/json" src="cve_list.json"></script>


    <script>
       
        /* Initialization of datatable */
        $(document).ready(function () {
            var startTime = new Date().getTime();
            table_settings = {
                "dom": 'flirtp<"dt-buttons"Bf>',
                "rowReorder": {
                    "selector": 'td:nth-child(2)'
                },
                "responsive": true,
                "paging": true,
                "processing": true,
                "deferRender": true,
                oLanguage: { sProcessing: "<div id='loader'></div>" },
                "buttons": [
                    'colvis',
                ],
                "bSortClasses": false,
                "bAutoWidth": false,
                "aoColumns": [
                    { "sWidth": "0.1%" },
                    { "sWidth": "0.1%" },
                    { "sWidth": "0.1%" },
                    { "sWidth": "0.1%" },
                    { "sWidth": "0.1%" },
                ],
                "order": [[ 1, "desc" ]],
                "orderClasses": false,
                "data": dataTable_data,
                initComplete: function () {
                    // Apply the search
                    this.api().columns().every(function () {
                        var that = this;

                        $('input', this.footer()).on('keyup change clear', function () {
                            if (that.search() !== this.value) {
                                that
                                    .search(this.value)
                                    .draw();
                            }
                        });
                    });


                }
            }

            $('#datatable tfoot th').each(function () {
                var title = $(this).text();
                $(this).html('<input type="text" placeholder="Search ' + title + '" />');
            });
            $("#datatable_length > label > select").removeClass("form-select form-select-sm");

            $('#overlay').show()
            $('#datatable').on('init.dt', function () {
                var endTime   = new Date().getTime();
                var totalTimeTaken = (endTime - startTime) / 1000;
                console.log('Table initialisation complete in: ' + totalTimeTaken + "s");
                $('#datatable').show();
                $('#overlay').hide()
                $("#datatable_length > label > select").removeClass("form-select form-select-sm");
            })
                .on('init', function () {
                    $('*[type="search"][class="form-control input-sm"]')
                        .addClass('input-lg')
                        .css({ 'width': '300px', 'display': 'inline-block' });
                    $('div.dataTables_filter').css({ 'margin-top': '1em' });
                    $("#datatable_length > label > select").removeClass("form-select form-select-sm");
                })
                .dataTable(table_settings);

        });
        $("#datatable_length > label > select").removeClass("form-select form-select-sm");
    </script>
</body>

</html>
